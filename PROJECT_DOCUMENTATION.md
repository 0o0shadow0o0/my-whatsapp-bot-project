# مشروع بوت واتساب مع واجهة تحكم ويب

## 1. نظرة عامة

هذا المشروع يوفر بوت واتساب متكامل مبني باستخدام Node.js ومكتبة Baileys (الإصدار الأحدث من @whiskeysockets/baileys)، مع واجهة تحكم ويب سهلة الاستخدام تمكنك من إرسال الرسائل، وجدولة الرسائل، ومراقبة نشاط البوت. تم تصميم المشروع ليكون قابلاً للتوسع بسهولة لإضافة ميزات وأوامر جديدة، وهو متوافق مع بيئة Termux على أجهزة أندرويد.

## 2. الميزات الرئيسية

*   **بوت واتساب أساسي:** اتصال موثوق بخدمة واتساب.
*   **طرق اتصال متعددة عبر واجهة الويب:**
    *   **مسح رمز QR:** يتم عرض رمز QR مباشرة في واجهة الويب لمسحه بواسطة تطبيق واتساب.
    *   **استخدام رمز الاقتران (Pairing Code):** يمكن للمستخدم اختيار هذه الطريقة من واجهة الويب، وإدخال رقم هاتفه، ليتم عرض رمز اقتران مكون من 8 أحرف وأرقام في واجهة الويب. يتم إدخال هذا الرمز في تطبيق واتساب على الهاتف الأساسي (الأجهزة المرتبطة > الربط برقم الهاتف).
*   **واجهة تحكم ويب شاملة:**
    *   اختيار طريقة الربط وعرض رمز QR أو رمز الاقتران للاتصال الأولي.
    *   إرسال رسائل واتساب مباشرة من المتصفح.
    *   عرض سجل الرسائل الواردة وحالة الاتصال.
    *   جدولة الرسائل: إضافة رسائل جديدة ليتم إرسالها في وقت محدد، عرض قائمة الرسائل المجدولة، وإلغاء أي رسالة مجدولة.
*   **جدولة الرسائل:** نظام داخلي لجدولة الرسائل يعتمد على تشغيل البوت. (ملاحظة: هذه الجدولة تعمل فقط طالما أن البوت قيد التشغيل. إذا توقف البوت، لن يتم إرسال الرسائل المجدولة التي لم يحن وقتها بعد).
*   **نظام أوامر قابل للتوسع:** يمكن إضافة أوامر جديدة للبوت بسهولة عبر إنشاء ملفات JavaScript منفصلة في مجلد `src/bot/commands`.
*   **دعم Termux:** تم مراعاة التوافق مع بيئة Termux لتشغيل البوت على أجهزة أندرويد.

## 3. هيكل المشروع

```
my-whatsapp-bot/
├── config/
│   └── settings.js         # إعدادات البوت الأساسية (رقم المالك، اسم البوت، إلخ)
├── data/
│   └── scheduled_messages.json # ملف لتخزين الرسائل المجدولة (يتم إنشاؤه تلقائياً)
├── session/
│   └── baileys_auth_info/  # ملفات جلسة الاتصال بواتساب (يتم إنشاؤها تلقائياً)
├── src/
│   ├── bot/
│   │   ├── commands/         # مجلد لتخزين ملفات الأوامر المخصصة
│   │   │   └── ping.js       # مثال لأمر بسيط
│   │   ├── index.js          # الملف الرئيسي لتشغيل البوت والاتصال بواتساب
│   │   └── messageScheduler.js # منطق جدولة الرسائل
│   └── web/
│       ├── public/           # الملفات الثابتة لواجهة الويب (HTML, CSS, JS للعميل)
│       │   ├── client.js     # كود JavaScript لواجهة العميل (المتصفح)
│       │   └── index.html    # صفحة الويب الرئيسية للتحكم
│       └── server.js         # خادم الويب (Express.js) و WebSocket
├── .gitignore                # ملف لتحديد الملفات والمجلدات التي يجب تجاهلها بواسطة Git
├── package.json              # تعريف المشروع والاعتماديات
├── package-lock.json         # قفل إصدارات الاعتماديات
├── PROJECT_DOCUMENTATION.md  # هذا الملف (التوثيق الشامل)
└── README.md                 # معلومات عامة عن المشروع (تم إنشاؤه مبدئياً)
```

## 4. تعليمات الإعداد والتشغيل (خاصة بـ Termux)

1.  **تثبيت Termux:** قم بتنزيل وتثبيت تطبيق Termux من متجره الرسمي (مثل F-Droid).
2.  **تحديث الحزم:** افتح Termux وقم بتحديث الحزم:
    ```bash
    pkg update && pkg upgrade -y
    ```
3.  **تثبيت Node.js و Git:**
    ```bash
    pkg install nodejs-lts git -y
    ```
4.  **تثبيت أدوات البناء (إذا لزم الأمر لبعض الاعتماديات):**
    ```bash
    pkg install build-essential python -y
    ```
5.  **نسخ المشروع:** قم بنسخ ملفات المشروع إلى جهازك (مثلاً، عبر نقل ملف ZIP وفك ضغطه، أو باستخدام `git clone` إذا كان المشروع على مستودع Git).
    افترض أنك وضعت المشروع في مجلد باسم `my-whatsapp-bot` داخل المجلد الرئيسي لـ Termux.
    ```bash
    cd ~/my-whatsapp-bot
    ```
6.  **تثبيت الاعتماديات:**
    ```bash
    npm install
    ```
    قد يستغرق هذا بعض الوقت.

7.  **تعديل الإعدادات (هام):**
    افتح ملف `config/settings.js` باستخدام محرر نصوص (مثل `nano` أو `vim` في Termux، أو أي محرر على جهاز الكمبيوتر قبل نقل الملفات):
    ```bash
    nano config/settings.js
    ```
    وقم بتعديل `ownerNumber` إلى رقم واتساب الخاص بك بالصيغة الدولية متبوعاً بـ `@s.whatsapp.net` (مثال: `9665xxxxxxx@s.whatsapp.net`). يمكنك أيضاً تعديل `botName` و `prefix` حسب رغبتك.

8.  **تشغيل البوت:**
    ```bash
    npm start
    ```
    عند تشغيل البوت، سيبدأ خادم الويب تلقائياً. ستظهر في الطرفية رسائل تفيد ببدء تشغيل الخادم وحالة اتصال البوت بواتساب.

9.  **الوصول إلى واجهة الويب والاتصال بواتساب (عند التشغيل لأول مرة أو بعد حذف الجلسة):**
    *   بعد تشغيل البوت بنجاح (الأمر `npm start`)، سيعمل خادم الويب على المنفذ المحدد في `config/settings.js` (الافتراضي هو `3000`).
    *   لمعرفة عنوان IP لجهازك الذي يعمل عليه Termux، يمكنك استخدام الأمر `ifconfig` في نافذة Termux جديدة (قد تحتاج لتثبيت `net-tools` عبر `pkg install net-tools`). ابحث عن عنوان IP المحلي (عادة ما يبدأ بـ `192.168.x.x` أو مشابه).
    *   من أي جهاز على نفس الشبكة (مثل الكمبيوتر أو هاتف آخر)، افتح المتصفح واكتب: `http://<عنوان_IP_لجهاز_Termux>:3000`.
        *   مثال: `http://192.168.1.105:3000`.
        *   إذا كنت تفتح المتصفح من نفس جهاز الأندرويد الذي يعمل عليه Termux، يمكنك استخدام: `http://localhost:3000`.
    *   **عند فتح واجهة الويب لأول مرة (إذا لم يكن الحساب مرتبطاً):**
        *   ستظهر لك واجهة لاختيار طريقة الربط بحساب واتساب.
        *   **الخيار 1: مسح رمز QR:**
            1.  من القائمة المنسدلة "يرجى اختيار طريقة الربط"، تأكد من اختيار "مسح رمز QR" (عادة ما يكون الخيار الافتراضي).
            2.  انقر على زر "بدء عملية الربط".
            3.  سيظهر رمز QR مباشرة في صفحة الويب.
            4.  من هاتفك الأساسي، افتح واتساب > الإعدادات (أو الثلاث نقاط) > الأجهزة المرتبطة > ربط جهاز، ثم امسح رمز QR المعروض في صفحة الويب.
        *   **الخيار 2: استخدام رمز الاقتران:**
            1.  من القائمة المنسدلة "يرجى اختيار طريقة الربط"، اختر "استخدام رمز الاقتران".
            2.  سيظهر حقل لإدخال "رقم هاتفك (مع رمز الدولة)". أدخل رقم هاتفك الذي تريد ربطه بالبوت (مثال: `+966500000000`).
            3.  انقر على زر "بدء عملية الربط".
            4.  سيظهر رمز اقتران مكون من 8 أحرف وأرقام في صفحة الويب (مثال: `ABCD-1234`).
            5.  من هاتفك الأساسي، افتح واتساب > الإعدادات (أو الثلاث نقاط) > الأجهزة المرتبطة > ربط جهاز.
            6.  اختر "الربط باستخدام رقم الهاتف بدلاً من ذلك" (أو ما شابه حسب واجهة واتساب لديك).
            7.  أدخل رمز الاقتران المكون من 8 خانات الذي ظهر في صفحة الويب.
    *   بعد نجاح عملية الربط بأي من الطريقتين، ستختفي واجهة الربط وستظهر لك لوحة التحكم الرئيسية للبوت في المتصفح، ويمكنك البدء في استخدام ميزات إرسال وجدولة الرسائل. ستظهر رسالة في الطرفية تفيد بنجاح الاتصال.

## 5. كيفية إضافة أوامر جديدة

1.  اذهب إلى المجلد `src/bot/commands/`.
2.  أنشئ ملف JavaScript جديد باسم الأمر (مثلاً، `info.js`).
3.  اكتب كود الأمر بالتنسيق التالي (مثال `info.js`):
    ```javascript
    module.exports = {
        name: "info", // اسم الأمر الذي سيتم استدعاؤه (مثلاً: .info)
        description: "يعرض معلومات عن البوت.",
        cooldown: 10, // فترة الانتظار بالثواني قبل استخدام الأمر مرة أخرى (اختياري)
        async execute(sock, msg, args) {
            // sock: هو كائن الاتصال بواتساب (Baileys socket)
            // msg: هو كائن الرسالة الواردة
            // args: هي مصفوفة تحتوي على الوسائط المدخلة مع الأمر

            const sender = msg.key.remoteJid;
            const botInfo = `🤖 اسم البوت: ${require("../../../config/settings").botName}\n👨‍💻 المطور: Manus AI`;
            await sock.sendMessage(sender, { text: botInfo });
        }
    };
    ```
4.  سيتم تحميل الأمر تلقائياً عند إعادة تشغيل البوت.

## 6. الأمان والمخاطر

*   **الاعتماد على مكتبات مفتوحة المصدر:** هذا المشروع يعتمد بشكل أساسي على مكتبة `@whiskeysockets/baileys`، وهي مكتبة مفتوحة المصدر معروفة ومستخدمة على نطاق واسع للتفاعل مع واتساب. الكود المصدري للمكتبة وللمشروع نفسه متاح للمراجعة.
*   **لا توجد برمجيات خبيثة مقصودة:** تم بناء هذا المشروع بهدف توفير الأدوات المطلوبة بطريقة شفافة. لا يتضمن المشروع أي أكواد تهدف إلى سرقة البيانات أو إلحاق الضرر بحسابك بشكل مقصود.
*   **ممارسات برمجية قياسية:** تم اتباع ممارسات برمجية قياسية لضمان أن الكود نظيف وآمن قدر الإمكان.
*   **مخاطر استخدام تطبيقات الطرف الثالث:** من المهم أن تكون على دراية بأن استخدام أي تطبيقات أو أدوات طرف ثالث للتفاعل مع منصات مثل واتساب قد يحمل نسبة صغيرة من المخاطرة. سياسات واتساب قد تتغير، وقد تعتبر استخدام مثل هذه الأدوات مخالفاً لشروط الخدمة الخاصة بها في بعض الحالات، مما قد يؤدي إلى تحذيرات أو حظر مؤقت أو دائم للحساب. **استخدم هذا المشروع على مسؤوليتك الخاصة.**
*   **توصيات لتقليل المخاطر:**
    *   تجنب إرسال رسائل جماعية (سبام) بشكل مفرط.
    *   تجنب استخدام البوت في أنشطة تنتهك شروط خدمة واتساب.
    *   يفضل استخدام رقم واتساب ثانوي أو مخصص للبوت إذا كنت قلقاً بشأن حسابك الرئيسي.
    *   حافظ على تحديث مكتبة Baileys والمشروع نفسه إلى أحدث الإصدارات المتاحة، حيث قد تتضمن تحديثات أمان أو توافق.

## 7. ملاحظات هامة

*   **استمرار التشغيل في Termux:** لضمان بقاء البوت يعمل في الخلفية حتى بعد إغلاق نافذة Termux، يمكنك استخدام `termux-wake-lock` قبل تشغيل البوت، أو تشغيله داخل جلسة `tmux` أو `screen`.
*   **استهلاك البطارية:** تشغيل بوت واتساب بشكل مستمر على الهاتف قد يستهلك البطارية. راقب ذلك.
*   **قيود جدولة الرسائل:** كما ذكر سابقاً، ميزة جدولة الرسائل تعتمد كلياً على بقاء البوت قيد التشغيل ومتصلاً بالإنترنت. إذا توقف البوت، لن يتم إرسال الرسائل المجدولة.

نتمنى أن يكون هذا المشروع مفيداً لك!

